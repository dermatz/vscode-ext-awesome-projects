# Copilot Instructions for Awesome Projects VS Code Extension

## Project Overview
This is a VS Code extension for managing and organizing projects with intuitive webview interface. The extension provides project bookmarking, Git integration, environment URL management, and drag-and-drop functionality.

## Architecture

### Core Components
- **Extension Entry Point**: `src/extension.ts` - Main activation, command registration, project ID migration
- **Webview Provider**: `src/webviewProvider.ts` - Manages the main UI webview with performance caching
- **Command System**: `src/commands.ts` - VS Code command handlers with consistent error handling
- **Project Templates**: `src/template/` - HTML generation system for webview components

### Data Flow
1. Projects stored in VS Code configuration (`awesomeProjects.projects`)
2. WebviewProvider caches configuration and static resources for performance
3. Templates generate HTML with TypeScript functions, not template files
4. Webview communicates via `WebviewMessage` interface
5. Commands update configuration and invalidate caches

### Key Patterns

#### Configuration Caching
WebviewProvider implements aggressive caching to avoid repeated `vscode.workspace.getConfiguration()` calls:
```typescript
// Always invalidate cache after configuration updates
this._configurationLoaded = false;
this._cachedConfiguration = undefined;
```

#### Static Resource Loading
CSS, header, and footer are loaded once and cached (`_cssLoaded`, `_headerLoaded`, `_footerLoaded`).

#### Project ID System
Projects use generated IDs from `getProjectId()` for consistent identification across operations.

## Development Workflow

### Build System
- **Development**: `npm run watch` (webpack + TypeScript compilation)
- **Testing**: `npm run watch-tests` (background test compilation)
- **Production**: `npm run vscode:prepublish` (includes CSS copying)

### Testing Strategy
- Unit tests in `src/test/` using Mocha
- Webview provider tests focus on cache behavior and configuration updates
- Performance tests verify static resource loading efficiency

### Webview Development
1. HTML generated by TypeScript functions in `src/template/`
2. CSS bundled from `src/css/webview.css` to `dist/css/`
3. Client-side scripts embedded in template functions
4. Message passing via `WebviewMessage` interface

## Critical Integration Points

### VS Code Configuration
Projects stored as array in `awesomeProjects.projects` setting with schema validation for required `path` and `name` fields.

### File System Operations
- Cross-platform file manager integration via `showInFileManager` command
- Git repository scanning with depth limits (`scanForProjects.ts`)
- Path normalization for Windows/Unix compatibility

### Performance Considerations
- Static resources cached during webview initialization
- Configuration caching with manual invalidation triggers
- Async project scanning with concurrency limits
- Loading indicators for long-running operations

## Project-Specific Conventions

### Error Handling
Always use try-catch with user-friendly VS Code error messages:
```typescript
vscode.window.showErrorMessage(`Failed to ${operation}: ${error}`);
```

### TypeScript Patterns
- Dual project interfaces: `src/extension.ts` (required id) vs `src/types.ts` (optional id)
- Message-based communication with strict typing via `WebviewMessage`
- Async/await with proper error propagation

### Webview Communication
- Commands use kebab-case (`awesome-projects.addProject`)
- Message commands use camelCase (`updateProject`, `deleteProject`)
- Always include projectId for project-specific operations

## Key Files for Understanding
- `src/webviewProvider.ts` - Main UI logic and caching strategy
- `src/template/project/projectlist.ts` - Project rendering system
- `src/types/webviewMessages.ts` - Communication interface
- `webpack.config.js` - Build configuration with CSS copying
- `package.json` - VS Code contribution points and commands
